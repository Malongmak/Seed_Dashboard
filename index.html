<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>SBMS – Seed Management System (Interactive)</title>
  <meta name="description" content="Interactive web interface for Seed Management System (A3‑SEED/IFDC)" />
  <!-- TailwindCSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- Icons & Charts & Map -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"/>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <style>
    :root{
      --green:#2d6a4f; --green-600:#1b4332; --green-100:#e9f5ee;
      --orange:#ff8c42; --bg:#f6faf7; --surface:#ffffff; --ring:#b7e1cd;
    }
    .chip{background:var(--green-100); color:var(--green); padding:.2rem .5rem; border-radius:999px; font-size:.75rem; font-weight:700}
    /* pretty scrollbar */
    ::-webkit-scrollbar{height:10px;width:10px}::-webkit-scrollbar-thumb{background:#cbd5e1;border-radius:999px}
  </style>
</head>
<body class="bg-[var(--bg)] text-neutral-900">
  <!-- LOGIN / LANDING -->
  <section id="screen-login" class="min-h-screen grid place-items-center bg-gradient-to-br from-[var(--green-100)] to-white px-4">
    <div class="w-full max-w-5xl grid md:grid-cols-2 gap-4">
      <div class="rounded-2xl border bg-white shadow p-6">
        <div class="bg-gradient-to-br from-[var(--green)] to-[var(--green-600)] text-white rounded-2xl p-6">
          <div class="flex items-center gap-2 font-extrabold text-2xl">
            <i class="fa-solid fa-seedling"></i>
            <span>A3‑SEED · SBMS</span>
          </div>
          <p class="opacity-90 mt-2">Accelerating Agriculture & Agribusiness in South Sudan</p>
          <div class="flex gap-2 mt-3 flex-wrap">
            <span class="chip !bg-white/20 !text-white">IFDC</span>
            <span class="chip !bg-white/20 !text-white">KIT Royal Tropical Institute</span>
            <span class="chip !bg-white/20 !text-white">Netherlands Embassy</span>
          </div>
        </div>
        <p class="text-sm text-neutral-600 mt-4">Digitizing the seed value chain from foundation seed to sales. Choose a role to explore the conceptual interface.</p>
        <div id="offlineMsg" class="hidden mt-3 text-amber-800 bg-amber-50 border border-amber-200 rounded-xl px-3 py-2 text-sm">
          <i class="fa-solid fa-wifi-slash mr-2"></i> You're offline – data will cache and sync later.
        </div>
      </div>
      <div class="rounded-2xl border bg-white shadow p-6">
        <h2 class="font-bold text-xl">Role Selection & Sign‑in</h2>
        <label class="block text-sm text-neutral-600 mt-3">Email</label>
        <input id="email" type="email" placeholder="name@seedco.org" class="w-full border rounded-xl px-3 py-2 mt-1" />
        <label class="block text-sm text-neutral-600 mt-3">Password</label>
        <input id="pwd" type="password" placeholder="••••••••" class="w-full border rounded-xl px-3 py-2 mt-1" />
        <div class="grid grid-cols-2 gap-2 my-3">
          <button class="role btn border rounded-xl px-3 py-2" data-role="Seed Company"><i class="fa-solid fa-warehouse mr-2"></i>Seed Company</button>
          <button class="role btn border rounded-xl px-3 py-2" data-role="Agro‑Dealer"><i class="fa-solid fa-store mr-2"></i>Agro‑Dealer</button>
          <button class="role btn border rounded-xl px-3 py-2" data-role="Field Officer"><i class="fa-solid fa-person-digging mr-2"></i>Field Officer</button>
          <button class="role btn border rounded-xl px-3 py-2" data-role="Admin"><i class="fa-solid fa-user-gear mr-2"></i>Admin</button>
        </div>
        <div class="flex items-center justify-between">
          <div class="text-sm text-neutral-600">Selected role: <strong id="roleLabel" class="text-[var(--green)]">Seed Company</strong></div>
          <div class="flex items-center gap-2">
            <button class="border rounded-xl px-3 py-2" id="langToggle">EN / AR</button>
            <button id="enterBtn" class="bg-[var(--green)] text-white rounded-xl px-4 py-2 shadow">Enter</button>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- APP -->
  <section id="screen-app" class="hidden">
    <!-- TOPBAR -->
    <header class="sticky top-0 z-20 bg-white/90 backdrop-blur border-b">
      <div class="max-w-7xl mx-auto px-4 py-2 flex items-center justify-between">
        <div class="flex items-center gap-2">
          <i class="fa-solid fa-leaf text-[var(--green)]"></i>
          <span class="font-extrabold">SBMS</span>
          <span id="activeRole" class="text-xs text-neutral-600 border rounded-full px-2 py-0.5">Seed Company</span>
        </div>
        <div class="flex items-center gap-2">
          <button class="border rounded-xl px-3 py-1 text-xs" id="langTop">EN</button>
          <button class="border rounded-xl px-3 py-1"><i class="fa-regular fa-bell"></i></button>
          <span class="border rounded-full px-2 py-1 text-xs">User</span>
        </div>
      </div>
    </header>

    <div class="max-w-7xl mx-auto grid md:grid-cols-[260px_1fr]">
      <!-- SIDEBAR -->
      <aside class="border-r bg-white p-2 sticky top-12 h-[calc(100vh-48px)] overflow-auto">
        <nav class="grid gap-1" id="sideNav">
          <button data-view="dashboard" class="navbtn bg-[var(--green-100)] text-[var(--green)] rounded-xl px-3 py-2 text-left"><i class="fa-solid fa-gauge mr-2"></i><span data-i18n=\"Dashboard\">Dashboard</span></button>
          <button data-view="production" class="navbtn rounded-xl px-3 py-2 text-left"><i class="fa-solid fa-seedling mr-2"></i><span data-i18n=\"Production\">Production</span></button>
          <button data-view="processing" class="navbtn rounded-xl px-3 py-2 text-left"><i class="fa-solid fa-industry mr-2"></i><span data-i18n=\"Processing & Certification\">Processing & Certification</span></button>
          <button data-view="inventory" class="navbtn rounded-xl px-3 py-2 text-left"><i class="fa-solid fa-warehouse mr-2"></i><span data-i18n=\"Inventory\">Inventory</span></button>
          <button data-view="sales" class="navbtn rounded-xl px-3 py-2 text-left"><i class="fa-solid fa-cart-shopping mr-2"></i><span data-i18n=\"Sales\">Sales</span></button>
          <button data-view="profiles" class="navbtn rounded-xl px-3 py-2 text-left"><i class="fa-regular fa-user mr-2"></i><span data-i18n=\"Profiles\">Profiles</span></button>
          <button data-view="feedback" class="navbtn rounded-xl px-3 py-2 text-left"><i class="fa-regular fa-comments mr-2"></i><span data-i18n=\"Feedback\">Feedback</span></button>
          <button data-view="reports" class="navbtn rounded-xl px-3 py-2 text-left"><i class="fa-solid fa-chart-line mr-2"></i><span data-i18n=\"Reports\">Reports</span></button>
        </nav>
      </aside>

      <!-- CONTENT -->
      <main class="p-4 space-y-4">
        <!-- DASHBOARD -->
        <section id="view-dashboard" class="view">
          <div class="grid gap-3 md:grid-cols-4">
            <div class="bg-white rounded-2xl shadow p-4"><div class="text-sm text-neutral-600" data-i18n="Total Seed in Production">Total Seed in Production</div><div class="text-2xl font-extrabold text-[var(--green)]">420 MT</div></div>
            <div class="bg-white rounded-2xl shadow p-4"><div class="text-sm text-neutral-600" data-i18n="Certified Stock">Certified Stock</div><div class="text-2xl font-extrabold text-[var(--green)]">280 MT</div></div>
            <div class="bg-white rounded-2xl shadow p-4"><div class="text-sm text-neutral-600" data-i18n="Monthly Sales">Monthly Sales</div><div class="text-2xl font-extrabold text-[var(--green)]">95 MT</div></div>
            <div class="bg-white rounded-2xl shadow p-4"><div class="text-sm text-neutral-600" data-i18n="Farmer Satisfaction">Farmer Satisfaction</div><div class="text-2xl font-extrabold text-[var(--green)]">87%</div></div>
          </div>

          <div class="grid gap-4 md:grid-cols-3">
            <div class="bg-white rounded-2xl shadow p-4 md:col-span-2">
              <div class="font-semibold mb-2" data-i18n="Production vs Sales Over Time">Production vs Sales Over Time</div>
              <canvas id="lineChart" height="160"></canvas>
            </div>
            <div class="bg-white rounded-2xl shadow p-4">
              <div class="font-semibold mb-2" data-i18n="Distribution Map">Distribution Map</div>
              <div id="map" class="h-64 rounded-2xl border"></div>
            </div>
          </div>
        </section>

        <!-- PROFILES (Farmer) -->
        <section id="view-profiles" class="view hidden">
          <div class="flex items-center justify-between">
            <h2 class="text-xl font-bold" data-i18n="Farmer Profile">Farmer Profile</h2>
            <div class="flex items-center gap-2">
              <div class="relative">
                <i class="fa-solid fa-magnifying-glass absolute left-2 top-2.5 text-neutral-400"></i>
                <input placeholder="Search farmer…" class="pl-8 border rounded-xl px-3 py-2"/>
              </div>
              <button class="border rounded-xl px-3 py-2">+ Add</button>
            </div>
          </div>
          <div class="grid gap-4 md:grid-cols-3 mt-4">
            <div class="bg-white rounded-2xl shadow p-4 md:col-span-2 space-y-4">
              <div class="grid md:grid-cols-3 gap-3">
                <div class="bg-white border rounded-xl p-3"><div class="text-xs text-neutral-500">Name</div><div class="font-semibold">Nyamal Deng</div></div>
                <div class="bg-white border rounded-xl p-3"><div class="text-xs text-neutral-500">Location</div><div class="font-semibold">Bor, Jonglei</div></div>
                <div class="bg-white border rounded-xl p-3"><div class="text-xs text-neutral-500">Phone</div><div class="font-semibold">+211 92 000 000</div></div>
              </div>
              <div>
                <div class="font-semibold mb-2">Seed Purchase History</div>
                <div class="overflow-auto">
                  <table class="w-full text-sm">
                    <thead class="text-neutral-500">
                      <tr><th class="text-left py-2">Date</th><th class="text-left py-2">Variety</th><th class="text-left py-2">Quantity (kg)</th><th class="text-left py-2">Dealer</th></tr>
                    </thead>
                    <tbody>
                      <tr class="odd:bg-white even:bg-neutral-50"><td class="py-2">2025‑04‑12</td><td class="py-2">Sorghum KER‑1</td><td class="py-2">50</td><td class="py-2">Mingkaman Agro</td></tr>
                      <tr class="odd:bg-white even:bg-neutral-50"><td class="py-2">2025‑06‑02</td><td class="py-2">Maize OPV 12</td><td class="py-2">40</td><td class="py-2">Bor Town Seeds</td></tr>
                    </tbody>
                  </table>
                </div>
              </div>
              <div>
                <div class="font-semibold mb-2">Feedback</div>
                <div class="border rounded-xl p-3">
                  <div class="flex items-center gap-2"><span class="chip">4/5</span><span class="font-semibold">Germination good</span></div>
                  <p class="text-sm text-neutral-600 mt-1">"Yield was above average, please improve packaging."</p>
                </div>
              </div>
            </div>
            <div class="bg-white rounded-2xl shadow p-4">
              <div class="font-semibold mb-2">Dealer Coverage</div>
              <div class="h-64 rounded-2xl border grid place-items-center text-neutral-500">Map Placeholder · Coverage</div>
            </div>
          </div>
        </section>

        <!-- INVENTORY -->
        <section id="view-inventory" class="view hidden">
          <div class="flex items-center justify-between">
            <h2 class="text-xl font-bold" data-i18n="Inventory">Inventory</h2>
            <div class="flex items-center gap-2">
              <button class="border rounded-xl px-3 py-2" onclick="openQR()"><i class="fa-solid fa-qrcode mr-2"></i>Scan QR</button>
              <button class="bg-[var(--green)] text-white rounded-xl px-3 py-2">New Batch</button>
            </div>
          </div>
          <div class="overflow-auto mt-3">
            <table class="w-full text-sm">
              <thead class="text-neutral-500">
                <tr><th class="text-left py-2">Batch</th><th class="text-left py-2">Variety</th><th class="text-left py-2">Qty (kg)</th><th class="text-left py-2">Expiry</th><th class="text-left py-2">Status</th><th class="text-left py-2">QR</th></tr>
              </thead>
              <tbody id="invBody">
                <tr class="odd:bg-white even:bg-neutral-50"><td class="py-2">#B‑1024</td><td class="py-2">Maize OPV 12</td><td class="py-2">12,000</td><td class="py-2">2026‑03‑01</td><td class="py-2"><span class="chip">Certified</span></td><td class="py-2"><button class="border rounded px-2" onclick="showQR('B‑1024')">QR</button></td></tr>
                <tr class="odd:bg-white even:bg-neutral-50"><td class="py-2">#B‑1041</td><td class="py-2">Sorghum KER‑1</td><td class="py-2">8,400</td><td class="py-2">2026‑01‑20</td><td class="py-2"><span class="chip" style="background:#fff3cd;color:#92400e">Pending</span></td><td class="py-2"><button class="border rounded px-2" onclick="showQR('B‑1041')">QR</button></td></tr>
              </tbody>
            </table>
          </div>
        </section>

        <!-- SIMPLE PLACEHOLDERS -->
        <section id="view-production" class="view hidden">
          <div class="bg-white rounded-2xl shadow p-4"><h2 class="font-semibold">Production</h2><p class="text-neutral-600">Plans, crop stages, and field inspections (geo‑tagged).</p></div>
        </section>
        <section id="view-processing" class="view hidden">
          <div class="bg-white rounded-2xl shadow p-4"><h2 class="font-semibold">Processing & Certification</h2><p class="text-neutral-600">Processing status, certification requests, digital certificates.</p></div>
        </section>
        <section id="view-sales" class="view hidden">
          <div class="bg-white rounded-2xl shadow p-4"><h2 class="font-semibold">Sales & Distribution</h2><p class="text-neutral-600">Sales entry, reports, GPS mapping of outlets.</p></div>
        </section>
        <section id="view-feedback" class="view hidden">
          <div class="bg-white rounded-2xl shadow p-4"><h2 class="font-semibold">Customer Feedback</h2><p class="text-neutral-600">SMS/USSD capture, ratings, ticket resolution.</p></div>
        </section>
        <section id="view-reports" class="view hidden">
          <div class="bg-white rounded-2xl shadow p-4"><h2 class="font-semibold">Analytics & Reports</h2><p class="text-neutral-600">Monthly performance, certifications, exports (CSV/PDF).</p></div>
        </section>
      </main>
    </div>
  </section>

  <!-- QR MODAL -->
  <div id="qrModal" class="hidden fixed inset-0 bg-black/40 grid place-items-center">
    <div class="bg-white rounded-2xl shadow-xl w-[min(520px,94%)] p-4 relative">
      <button onclick="closeQR()" class="absolute right-3 top-3 border rounded-full w-8 h-8 grid place-items-center">✕</button>
      <h3 class="font-semibold text-lg mb-2">QR Scanner (Mock)</h3>
      <div class="h-56 rounded-2xl border-2 border-dashed grid place-items-center text-neutral-500">Camera Preview Placeholder</div>
      <div class="flex justify-end gap-2 mt-3">
        <button class="border rounded-xl px-3 py-2" onclick="closeQR()">Close</button>
        <button class="bg-[var(--orange)] text-white rounded-xl px-3 py-2" onclick="fakeScan()">Simulate Scan</button>
      </div>
      <div id="qrResult" class="text-sm text-neutral-600 mt-2"></div>
    </div>
  </div>

  <script>
    // --- Online/offline banner ---
    function updateOffline(){
      const off = !navigator.onLine;
      document.getElementById('offlineMsg').classList.toggle('hidden', !off);
    }
    window.addEventListener('online', updateOffline);
    window.addEventListener('offline', updateOffline);
    updateOffline();

    // --- Role selection ---
    let selectedRole = 'Seed Company';
    for (const b of document.querySelectorAll('.role')) {
      b.addEventListener('click', () => {
        selectedRole = b.dataset.role;
        document.getElementById('roleLabel').textContent = selectedRole;
      });
    }

    // --- Enter app ---
    document.getElementById('enterBtn').addEventListener('click', () => {
      document.getElementById('screen-login').classList.add('hidden');
      document.getElementById('screen-app').classList.remove('hidden');
      document.getElementById('activeRole').textContent = selectedRole;
      drawChart();
      drawMap();
    });

    // --- Sidebar router ---
    const nav = document.getElementById('sideNav');
    nav.addEventListener('click', (e) => {
      const btn = e.target.closest('.navbtn'); if(!btn) return;
      document.querySelectorAll('.navbtn').forEach(b=>b.classList.remove('bg-[var(--green-100)]','text-[var(--green)]'));
      btn.classList.add('bg-[var(--green-100)]','text-[var(--green)]');
      const target = btn.dataset.view;
      document.querySelectorAll('.view').forEach(v=>v.classList.add('hidden'));
      document.getElementById('view-'+target).classList.remove('hidden');
    });

    // --- Chart ---
    function drawChart(){
      const ctx = document.getElementById('lineChart');
      const data = {
        labels: ['Jan','Feb','Mar','Apr','May','Jun','Jul'],
        datasets: [
          { label: 'Production', data: [60,75,68,90,84,95,88], borderColor: '#2d6a4f', tension: 0.35 },
          { label: 'Sales', data: [50,58,55,70,66,78,72], borderColor: '#ff8c42', tension: 0.35 },
        ]
      };
      new Chart(ctx, { type: 'line', data, options: { responsive: true, plugins:{legend:{position:'bottom'}} } });
    }

    // --- Leaflet map ---
    let leafletMap;
    function drawMap(){
      leafletMap = L.map('map').setView([4.85, 31.6], 6);
      L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', { maxZoom: 18 }).addTo(leafletMap);
      L.marker([4.85,31.6]).addTo(leafletMap).bindPopup('Juba Dealer');
      L.circle([6.8, 29.7], {radius: 50000}).addTo(leafletMap).bindPopup('Wau Coverage');
    }

    // --- QR modal ---
    function openQR(){ document.getElementById('qrModal').classList.remove('hidden'); }
    function closeQR(){ document.getElementById('qrModal').classList.add('hidden'); document.getElementById('qrResult').textContent=''; }
    function showQR(id){ openQR(); document.getElementById('qrResult').textContent = 'Batch: '+id; }
    function fakeScan(){ document.getElementById('qrResult').textContent = 'Scanned → Batch #B‑2049 · Maize OPV 12 · 9,600 kg'; }

    // --- Minimal i18n (EN/AR labels) ---
    const dict = {
      ar: {
        'Dashboard':'لوحة التحكم','Production':'الإنتاج','Processing & Certification':'المعالجة والإعتماد','Inventory':'المخزون','Sales':'المبيعات','Profiles':'الملفات','Feedback':'التغذية الراجعة','Reports':'التقارير','Total Seed in Production':'إجمالي البذور قيد الإنتاج','Certified Stock':'المخزون المعتمد','Monthly Sales':'المبيعات الشهرية','Farmer Satisfaction':'رضا المزارعين','Production vs Sales Over Time':'الإنتاج والمبيعات عبر الزمن','Distribution Map':'خريطة التوزيع','Farmer Profile':'ملف المزارع'
      }
    };
    let lang = 'en';
    function applyLang(){
      document.querySelectorAll('[data-i18n]').forEach(el=>{
        const key = el.getAttribute('data-i18n');
        el.textContent = (lang==='ar' ? (dict.ar[key] || key) : key);
      });
      document.documentElement.dir = (lang==='ar') ? 'rtl' : 'ltr';
      document.getElementById('langTop').textContent = lang.toUpperCase();
    }
    document.getElementById('langToggle').addEventListener('click', ()=>{ lang = (lang==='en')?'ar':'en'; applyLang(); });
    document.getElementById('langTop').addEventListener('click', ()=>{ lang = (lang==='en')?'ar':'en'; applyLang(); });
  </script>
</body>
</html>
